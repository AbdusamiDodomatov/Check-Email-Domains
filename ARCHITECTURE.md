# Архитектура Telegram-бота для MX-проверки email

Цель: минимальная стоимость, высокая надёжность, обработка email на лету через Telegram.

---

## Идея в двух словах

- Один бот (Python) слушает Telegram-чат через Bot API.
- Получает email из сообщений, проверяет MX-записи через DNS.
- Отправляет результат обратно в тот же чат.
- Минимизация инфраструктуры: всё работает на одном компьютере или дешёвом VPS.

---

## Компоненты

1. **Telegram Bot**
   - Основной исполнитель, написан на Python.
   - Обрабатывает входящие сообщения и возвращает результат.
   - Использует `requests` для взаимодействия с Bot API и `dnspython` для проверки MX-записей.

2. **Storage / логирование (опционально)**
   - Можно сохранять историю проверок в JSON или SQLite.
   - Позволяет анализировать статистику и повторно проверять email при необходимости.

3. **Мониторинг**
   - Логи ошибок и тайм-аутов печатаются в консоль.
   - Возможность добавления внешнего мониторинга (например, Prometheus + Grafana) при необходимости работы 24/7.

---

## Обработка и распределение

- Бот последовательно обрабатывает входящие сообщения.
- Для нескольких email в одном сообщении выполняется проверка MX каждого.
- Отправка результатов обратно в тот же чат.
- Таймауты и ошибки API Telegram обрабатываются с повтором и паузами (устраняет падение бота).

---

## Риски и способы их закрытия

- **Тайм-аут Telegram API** — обработка `ReadTimeout` и увеличение таймаута до 30 секунд.
- **Падение бота** — скрипт можно запускать под supervisor / systemd / Task Scheduler, чтобы перезапускался автоматически.
- **Ошибки DNS / некорректные email** — проверка формата email и корректная обработка исключений `dnspython`.
- **Большие списки email** — можно разбивать на части и обрабатывать по batch.

---

## Масштабирование и стоимость

- Работает на локальном компьютере или дешёвом VPS (~$5–10/мес).  
- Для параллельной обработки нескольких чатов можно запустить несколько экземпляров бота.  
- Минимальные затраты на инфраструктуру и сервисы: практически $0, кроме хостинга, если нужен uptime 24/7.

---

## Заключение

- Простая и надёжная архитектура для проверки MX email через Telegram.  
- Минимум компонентов: бот + DNS-запросы + необязательное логирование.  
- Масштабируемость обеспечивается запуском нескольких экземпляров бота при необходимости.
